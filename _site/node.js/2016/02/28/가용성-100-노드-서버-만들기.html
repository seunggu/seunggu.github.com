<!DOCTYPE html>
<html>

  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>가용성 100% 노드 서버 만들기</title>
  <meta name="description" content="자신이 만든 서비스를 매일 사용해주는 사용자가 있습니다.그런 단골 사용자가 어느 날 서비스에 들어왔는데 “이 페이지는 찾을 수 없습니다”란 문구를 보고“서비스를 더 이상 운영하지 않나?”라고 생각이 들어 다음부터 오지 않는다면 그것만큼 서비스에 큰 피해가 생기는 것이 없겠죠.">
  
  <meta name="author" content="승구">
  <meta name="copyright" content="&copy; 승구 2016">
  

  <!-- External libraries -->
  <link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css">
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/8.5/styles/monokai_sublime.min.css">
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/lightbox2/2.7.1/css/lightbox.css">

  <!-- Favicon and other icons (made with http://www.favicon-generator.org/) -->
  <link rel="shortcut icon" href="/assets/icons/favicon.ico" type="image/x-icon">
  <link rel="icon" href="/assets/icons/favicon.ico" type="image/x-icon">
  <link rel="apple-touch-icon" sizes="57x57" href="/assets/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/assets/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/assets/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/assets/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/assets/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/assets/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/assets/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/assets/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/assets/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192"  href="/assets/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/assets/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/assets/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/assets/icons/favicon-16x16.png">
  <link rel="manifest" href="/assets/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/assets/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">

  
  <!-- Facebook OGP cards -->
  <meta property="og:description" content="자신이 만든 서비스를 매일 사용해주는 사용자가 있습니다.그런 단골 사용자가 어느 날 서비스에 들어왔는데 “이 페이지는 찾을 수 없습니다”란 문구를 보고“서비스를 더 이상 운영하지 않나?”라고 생각이 들어 다음부터 오지 않는다면 그것만큼 서비스에 큰 피해가 생기는 것이 없겠죠." />
  <meta property="og:url" content="http://seunggu.github.io" />
  <meta property="og:site_name" content="승구 개발 블로그" />
  <meta property="og:title" content="가용성 100% 노드 서버 만들기" />
  <meta property="og:type" content="website" />
  <meta property="og:image" content="http://seunggu.github.io/assets/instacode.png" />
  <meta property="og:image:type" content="image/png" />
  <meta property="og:image:width" content="322" />
  <meta property="og:image:height" content="79" />
  

  
  <!-- Twitter: card tags -->
  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="가용성 100% 노드 서버 만들기">
  <meta name="twitter:description" content="자신이 만든 서비스를 매일 사용해주는 사용자가 있습니다.그런 단골 사용자가 어느 날 서비스에 들어왔는데 “이 페이지는 찾을 수 없습니다”란 문구를 보고“서비스를 더 이상 운영하지 않나?”라고 생각이 들어 다음부터 오지 않는다면 그것만큼 서비스에 큰 피해가 생기는 것이 없겠죠.">
  <meta name="twitter:image" content="http://seunggu.github.io/assets/instacode.png">
  <meta name="twitter:url" content="http://seunggu.github.io">
  

  

  <!-- Site styles -->
  <link rel="stylesheet" href="/css/main.css">
  <link rel="canonical" href="http://seunggu.github.io/node.js/2016/02/28/%E1%84%80%E1%85%A1%E1%84%8B%E1%85%AD%E1%86%BC%E1%84%89%E1%85%A5%E1%86%BC-100-%E1%84%82%E1%85%A9%E1%84%83%E1%85%B3-%E1%84%89%E1%85%A5%E1%84%87%E1%85%A5-%E1%84%86%E1%85%A1%E1%86%AB%E1%84%83%E1%85%B3%E1%86%AF%E1%84%80%E1%85%B5.html">
  <link rel="alternate" type="application/rss+xml" title="승구 개발 블로그" href="http://seunggu.github.io/feed.xml" />
</head>

  <body>

    <header class="navigation" role="banner">
  <div class="navigation-wrapper">
    <a href="/" class="logo">
      
      <img src="/assets/main_logo2.png" alt="승구 개발 블로그">
      
    </a>
    <a href="javascript:void(0)" class="navigation-menu-button black-a" id="js-mobile-menu">
      <i class="fa fa-bars"></i>
    </a>
    <nav role="navigation">
      <ul id="js-navigation-menu" class="navigation-menu show">
        
        
        <li class="nav-link"><a class="black-a" href="/about/">About</a>
          
          
        
          
        
          
        
          
        
        <li class="nav-link"><a class="black-a" href="/posts/">Posts</a>
          
          
        
        <li class="nav-link"><a class="black-a" href="/typography/">Typography</a>
          
          
      </ul>
    </nav>
  </div>
</header>


    <div class="page-content">
        <div class="post">

<div class="post-header-container has-cover" style="background-image: url(/assets/instacode.png);">
  <div class="scrim has-cover">
    <header class="post-header">
      <h1 class="title">가용성 100% 노드 서버 만들기</h1>
      <p class="info">by <strong>승구</strong></p>
    </header>
  </div>
</div>

<div class="wrapper">



<section class="post-meta">
  <div class="post-date">February 28, 2016</div>
  <div class="post-categories">
  in 
    
    <span>Node.js</span>
    
  
  </div>
</section>  

<article class="post-content">
  <p>자신이 만든 서비스를 매일 사용해주는 사용자가 있습니다.
그런 단골 사용자가 어느 날 서비스에 들어왔는데 “이 페이지는 찾을 수 없습니다”란 문구를 보고
“서비스를 더 이상 운영하지 않나?”라고 생각이 들어 다음부터 오지 않는다면 그것만큼 서비스에 큰 피해가 생기는 것이 없겠죠.</p>

<p>그 만큼 서비스의 가용성을 높여 항상 클라이언트의 요청에 응답을 줄 수 있게 해주는 것이 중요한 것은
이 글을 읽으시는 분 모두 아실겁니다. 하지만 생각보다 노드를 운영하면서 가용성 100%에 도전하는 것은 생각보다 어렵습니다.</p>

<p>대규모 서버를 운영하시는 분들에겐 <a href="https://en.wikipedia.org/wiki/Load_balancing_(computing)">로드 밸런싱</a>라는 강력한 무기가 있지만,
서비스를 막 시작하거나 규모가 작은 서비스에서는 로드 밸런스 등이 오히려 부담이 될 수 있다고 생각합니다.
이번 포스트는 이런 분들에게 더욱 도움이 될 것 같습니다만,
대규모 서버에도 꼭 도입이 필요하다고 생각합니다.</p>

<h2 id="section">첫번째, 에러의 종류와 처리과정 알기</h2>

<p>먼저 노드에서 에러를 전달하는 3가지 방법이 있습니다.
* Error를 throw하는 방법. ex) throw new Erorr(‘error’);
* error 객체를 error handler callback에 전달하는 방법. ex) next(err);
* EventEmitter를 통해 “error” event emit</p>

<p>error 객체는 Error class의 instance입니다. error 객체는 handler 함수에 패스되거나 throw 할 수 있죠.
error 객체가 throw 되었을 때, exception이 됩니다.</p>

<p>You’ll find this post in your <code class="highlighter-rouge">_posts</code> directory. Go ahead and edit it and re-build the site to see your changes. You can rebuild the site in many different ways, but the most common way is to run <code class="highlighter-rouge">jekyll serve</code>, which launches a web server and auto-regenerates your site when a file is updated.</p>

<h2 id="adding-new-posts">Adding New Posts</h2>

<p>To add new posts, simply add a file in the <code class="highlighter-rouge">_posts</code> directory that follows the convention <code class="highlighter-rouge">YYYY-MM-DD-name-of-post.ext</code> and includes the necessary front matter. Take a look at the source for this post to get an idea about how it works.</p>

<h3 id="tags-and-categories">Tags and Categories</h3>

<p>If you list one or more categories or tags in the front matter of your post, they will be included with the post on the page as links. Clicking the link will bring you to an auto-generated archive page for the category or tag, created using the <a href="https://github.com/jekyll/jekyll-archives">jekyll-archive</a> gem.</p>

<h3 id="cover-images">Cover Images</h3>

<p>To add a cover image to your post, set the “cover” property in the front matter with the relative URL of the image (i.e. <code>cover: "/assets/cover_image.jpg"</code>).</p>

<h3 id="code-snippets">Code Snippets</h3>

<p>You can use <a href="https://highlightjs.org/">highlight.js</a> to add syntax highlight code snippets:</p>

<p>Use the <a href="https://github.com/Shopify/liquid/wiki/Liquid-for-Designers">Liquid</a> <code class="highlighter-rouge"><span class="p">{</span><span class="err">%</span><span class="w"> </span><span class="err">highlight</span><span class="w"> </span><span class="err">&lt;language&gt;</span><span class="w"> </span><span class="err">%</span><span class="p">}</span></code> tag to add syntax highlighting to code snippets.</p>

<p>For instance, this template…</p>

<figure class="highlight"><pre><code class="language-html" data-lang="html">{% highlight javascript %}    
function demo(string, times) {    
  for (var i = 0; i <span class="nt">&lt; times</span><span class="err">;</span> <span class="na">i</span><span class="err">++)</span> <span class="err">{</span>    
    <span class="na">console</span><span class="err">.</span><span class="na">log</span><span class="err">(</span><span class="na">string</span><span class="err">);</span>    
  <span class="err">}</span>    
<span class="err">}</span>    
<span class="na">demo</span><span class="err">("</span><span class="na">hello</span><span class="err">,</span> <span class="na">world</span><span class="err">!",</span> <span class="na">10</span><span class="err">);</span>
<span class="err">{%</span> <span class="na">endhighlight</span> <span class="err">%}</span></code></pre></figure>

<p>…will come out looking like this:</p>

<figure class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="kd">function</span> <span class="nx">demo</span><span class="p">(</span><span class="nx">string</span><span class="p">,</span> <span class="nx">times</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">times</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">string</span><span class="p">);</span>
  <span class="p">}</span>
<span class="p">}</span>
<span class="nx">demo</span><span class="p">(</span><span class="s2">"hello, world!"</span><span class="p">,</span> <span class="mi">10</span><span class="p">);</span></code></pre></figure>

<p>Syntax highlighting is done using <a href="https://highlightjs.org/">highlight.js</a>. You can change the active theme in <a href="https://github.com/bencentra/centrarium/blob/2dcd73d09e104c3798202b0e14c1db9fa6e77bc7/_includes/head.html#L15">head.html</a>.</p>

<h3 id="images">Images</h3>

<p>Lightbox has been enabled for images. To create the link that’ll launch the lightbox, add <code>data-lightbox</code> and <code>data-title</code> attributes to an <code>&lt;a&gt;</code> tag around your <code>&lt;img&gt;</code> tag. The result is:</p>

<p><a href="//bencentra.com/assets/images/falcon9_large.jpg" data-lightbox="falcon9-large" data-title="Check out the Falcon 9 from SpaceX">
  <img src="//bencentra.com/assets/images/falcon9_small.jpg" title="Check out the Falcon 9 from SpaceX" />
</a></p>

<p>For more information, check out the <a href="http://lokeshdhakar.com/projects/lightbox2/">Lightbox</a> website.</p>

<p>Check out the <a href="http://jekyllrb.com">Jekyll docs</a> for more info on how to get the most out of Jekyll. File all bugs/feature requests at <a href="https://github.com/jekyll/jekyll">Jekyll’s GitHub repo</a>. If you have questions, you can ask them on <a href="https://github.com/jekyll/jekyll-help">Jekyll’s dedicated Help repository</a>.</p>

<h3 id="section-1">참고 사이트</h3>
<ul>
  <li><a href="http://nodeqa.com/nodejs_ref/106">[cookbook]올바른 Exception 처리방법</a></li>
  <li><a href="http://nodeqa.com/nodejs_ref/19">[cookbook] Domain API (또다른 try ~ catch)</a></li>
  <li><a href="https://engineering.gosquared.com/error-handling-using-domains-node-js">Crash safety using domains in Node.js</a></li>
  <li><a href="http://engineering.fluencia.com/blog/2013/12/20/the-4-keys-to-100-uptime-with-nodejs">THE 4 KEYS TO 100% UPTIME WITH NODE.JS</a></li>
  <li><a href="https://www.joyent.com/developers/node/design/errors">Error Handling in Node.js</a></li>
</ul>


</article>



<section class="rss">
  <p class="rss-subscribe text"><strong>Subscribe <a href="/feed.xml">via RSS</a></strong></p>
</section>

<section class="share">
  <span>Share: </span>
  
    
    
      <a href="//twitter.com/share?text=%EA%B0%80%EC%9A%A9%EC%84%B1+100%25+%EB%85%B8%EB%93%9C+%EC%84%9C%EB%B2%84+%EB%A7%8C%EB%93%A4%EA%B8%B0&url=http://seunggu.github.io/node.js/2016/02/28/%E1%84%80%E1%85%A1%E1%84%8B%E1%85%AD%E1%86%BC%E1%84%89%E1%85%A5%E1%86%BC-100-%E1%84%82%E1%85%A9%E1%84%83%E1%85%B3-%E1%84%89%E1%85%A5%E1%84%87%E1%85%A5-%E1%84%86%E1%85%A1%E1%86%AB%E1%84%83%E1%85%B3%E1%86%AF%E1%84%80%E1%85%B5.html&via=imaster0209"
        onclick="window.open(this.href, 'twitter-share', 'width=550,height=255');return false;">
        <i class="fa fa-twitter-square fa-lg"></i>
      </a>
    
    
    
    
    
    
  
    
    
    
      <a href="//www.facebook.com/sharer.php?t=%EA%B0%80%EC%9A%A9%EC%84%B1+100%25+%EB%85%B8%EB%93%9C+%EC%84%9C%EB%B2%84+%EB%A7%8C%EB%93%A4%EA%B8%B0&u=http://seunggu.github.io/node.js/2016/02/28/%E1%84%80%E1%85%A1%E1%84%8B%E1%85%AD%E1%86%BC%E1%84%89%E1%85%A5%E1%86%BC-100-%E1%84%82%E1%85%A9%E1%84%83%E1%85%B3-%E1%84%89%E1%85%A5%E1%84%87%E1%85%A5-%E1%84%86%E1%85%A1%E1%86%AB%E1%84%83%E1%85%B3%E1%86%AF%E1%84%80%E1%85%B5.html"
        onclick="window.open(this.href, 'facebook-share', 'width=550,height=255');return false;">
        <i class="fa fa-facebook-square fa-lg"></i>
      </a>
    
    
    
    
    
  
    
    
    
    
    
    
    
  
    
    
    
    
    
    
    
  
    
    
    
    
    
    
    
  
    
    
    
    
    
    
    
  
    
    
    
    
    
    
    
  
    
    
    
    
    
    
    
  
    
    
    
    
    
    
    
  
    
    
    
    
    
    
    
  
    
    
    
    
    
    
    
  
    
    
    
    
    
    
    
  
    
    
    
    
    
    
    
  
    
    
    
    
    
    
    
  
    
    
    
    
    
    
    
  
</section>




<section class="disqus">
  <div id="disqus_thread"></div>
  <script type="text/javascript">
    var disqus_shortname = 'seunggu';

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
  </script>
  <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
  <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
</section>



</div>
</div>

    </div>

    <footer class="site-footer">

  <div class="wrapper">

    <h3 class="footer-heading">승구 개발 블로그</h3>

    <div class="site-navigation">

      <p><strong>Site Map</strong></p>
      <ul class="pages">
        
        
        <li class="nav-link"><a href="/about/">About</a>
          
          
        
          
        
          
        
          
        
        <li class="nav-link"><a href="/posts/">Posts</a>
          
          
        
        <li class="nav-link"><a href="/typography/">Typography</a>
          
          
      </ul>
    </div>

    <div class="site-contact">

      <p><strong>Contact</strong></p>
      <ul class="social-media-list">
        <li>
          <a href="mailto:imaster0029@naver.com">
            <i class="fa fa-envelope-o"></i>
            <span class="username">imaster0029@naver.com</span>
          </a>
        </li>

        
        
        <li>
          <a href="https://twitter.com/imaster0209" title="Follow me on Twitter">
            <i class="fa fa-twitter"></i>
            <span class="username">imaster0209</span>
          </a>
        </li>
        
        
        
        
        
        <li>
          <a href="https://github.com/seunggu" title="Fork me on GitHub">
            <i class="fa fa-github"></i>
            <span class="username">seunggu</span>
          </a>
        </li>
        
        
        
        <li>
          <a href="https://www.linkedin.com/pub/ben-centra/47/769/60a" title="Connect with me on LinkedIn">
            <i class="fa fa-linkedin"></i>
            <span class="username">Ben Centra</span>
          </a>
        </li>
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        

      </ul>
    </div>

    <div class="site-signature">
      <p class="rss-subscribe text"><strong>Subscribe <a href="/feed.xml">via RSS</a></strong></p>
      <p class="text">A Blog dealing with JavaScript, NodeJS, AngularJS, Ionic, iOS, etc...
</p>
    </div>

  </div>

</footer>

<!-- Scripts -->
<script src="//code.jquery.com/jquery-1.11.2.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/8.5/highlight.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/lightbox2/2.7.1/js/lightbox.min.js"></script>
<script>

  $(document).ready(function() {

    // Syntax highlighting
    hljs.initHighlightingOnLoad();

    // Header
    var menuToggle = $('#js-mobile-menu').unbind();
    $('#js-navigation-menu').removeClass("show");
    menuToggle.on('click', function(e) {
      e.preventDefault();
      $('#js-navigation-menu').slideToggle(function(){
        if($('#js-navigation-menu').is(':hidden')) {
          $('#js-navigation-menu').removeAttr('style');
        }
      });
    });


  });

</script>




  </body>

</html>
